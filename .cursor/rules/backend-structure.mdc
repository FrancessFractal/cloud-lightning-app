---
description: Backend module structure — read backend/README.md before modifying backend code
globs: backend/**/*.py
alwaysApply: false
---

# Backend Structure

Before modifying backend Python files, read `backend/README.md` for the module
overview. It describes each module's responsibility, public functions, and
dependency flow.

Key boundaries:
- `app.py` — routes only, no business logic
- `weather.py` — aggregation, interpolation logic, parallel CSV pre-fetching
- `quality.py` — data quality assessment (report-card model)
- `stations.py` — station queries and adaptive selection
- `smhi_client.py` — SMHI API access, CSV parsing, file + memory cache
- `preloader.py` — background pre-loader (downloads all station data on startup)
- `geocoding.py` — Nominatim address lookup (independent of SMHI)

Do not add business logic to `app.py`. Do not add HTTP/routing concerns to
the other modules. The preloader can be disabled via `SKIP_PRELOAD=1`.
